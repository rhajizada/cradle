---
pre-commit:
  parallel: true
  commands:
    end-of-file-fixer:
      run: |
        sed -i '' -e '$a\' {staged_files}

    trailing-whitespace:
      run: |
        sed -i '' -e 's/[[:space:]]\+$//' {staged_files}

    merge-conflict:
      run: |
        git diff --cached --check

    format:
      glob: "*.go"
      run: |
        go run mvdan.cc/gofumpt@v0.9.2 -w {staged_files}
        git add {staged_files}

pre-push:
  parallel: false
  commands:
    lint:
      run: |
        go run github.com/golangci/golangci-lint/v2/cmd/golangci-lint@v2.8.0 run --timeout=5m

    tests:
      run: |
        go run gotest.tools/gotestsum@v1.13.0 -- ./...
